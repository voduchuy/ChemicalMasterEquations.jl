<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Transient solution of the CME · 𝕹𝖚𝖒ℂ𝕄𝔼</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">𝕹𝖚𝖒ℂ𝕄𝔼</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/telegraph/">Telegraphic gene expression</a></li><li><a class="tocitem" href="../../examples/hog1p/">MAPK-activated transcription in yeast</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><a class="tocitem" href="../models/">CME models</a></li><li><a class="tocitem" href="../propensities/">Propensity functions</a></li><li><a class="tocitem" href="../propensity_gradients/">Gradients of propensity functions</a></li><li><a class="tocitem" href="../space/">Managing state space</a></li><li><a class="tocitem" href="../vectors/">Representing the CME solution</a></li><li class="is-active"><a class="tocitem" href>Transient solution of the CME</a><ul class="internal"><li><a class="tocitem" href="#FSP-variant-specification"><span>FSP variant specification</span></a></li><li><a class="tocitem" href="#State-space-adaptation-policies"><span>State space adaptation policies</span></a></li><li><a class="tocitem" href="#FSP-output-format"><span>FSP output format</span></a></li><li><a class="tocitem" href="#solve()-method"><span><code>solve()</code> method</span></a></li></ul></li><li><a class="tocitem" href="../cmesenssolve/">Forward sensitivity analysis</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API reference</a></li><li class="is-active"><a href>Transient solution of the CME</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Transient solution of the CME</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/voduchuy/NumCME.jl/blob/main/docs/src/api/cmesolve.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Transient-solution-of-the-CME"><a class="docs-heading-anchor" href="#Transient-solution-of-the-CME">Transient solution of the CME</a><a id="Transient-solution-of-the-CME-1"></a><a class="docs-heading-anchor-permalink" href="#Transient-solution-of-the-CME" title="Permalink"></a></h1><h2 id="FSP-variant-specification"><a class="docs-heading-anchor" href="#FSP-variant-specification">FSP variant specification</a><a id="FSP-variant-specification-1"></a><a class="docs-heading-anchor-permalink" href="#FSP-variant-specification" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NumCME.AdaptiveFspSparse" href="#NumCME.AdaptiveFspSparse"><code>NumCME.AdaptiveFspSparse</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct AdaptiveFspSparse &lt;: TransientCmeAlgorithm</code></pre><p>Struct to store adaptive Finite State Projection algorithmic options. This type is intended to work with <code>solve()</code> methods that output CME solutions as sparse vectors of type <code>FspVectorSparse</code>. </p><p><strong>Fields</strong></p><pre><code class="nohighlight hljs">ode_method</code></pre><p>Instance of an ODE algorithm from the <code>DifferentialEquations.jl</code> package.</p><pre><code class="nohighlight hljs">space_adapter</code></pre><p>Method to adapt the FSP state space when truncation error exceeds user-specified tolerance.</p><p><strong>See also</strong></p><p><a href="#NumCME.RStepAdapter"><code>RStepAdapter</code></a>, <a href="../vectors/#NumCME.FspVectorSparse"><code>FspVectorSparse</code></a>, <a href="../models/#NumCME.CmeModel"><code>CmeModel</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/fspsolve.jl#L43-L58">source</a></section></article><h2 id="State-space-adaptation-policies"><a class="docs-heading-anchor" href="#State-space-adaptation-policies">State space adaptation policies</a><a id="State-space-adaptation-policies-1"></a><a class="docs-heading-anchor-permalink" href="#State-space-adaptation-policies" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NumCME.RStepAdapter" href="#NumCME.RStepAdapter"><code>NumCME.RStepAdapter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct RStepAdapter &lt;: AbstractSpaceAdapterSparse</code></pre><p>Simple adapter based on reachability. Whenever the current FSP solution error is found to exceed the acceptable tolerance, the adapter will expand the state space by exploring all states that could be reached from the current state space within a set number of reaction events.</p><p>This adapter only works with <code>StateSpaceSparse</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/rstepadapters.jl#L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.SelectiveRStepAdapter" href="#NumCME.SelectiveRStepAdapter"><code>NumCME.SelectiveRStepAdapter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct SelectiveRStepAdapter &lt;: AbstractSpaceAdapterSparse</code></pre><p>Adapter based on reachability. This adapter only explore new states through reaction channels with positive derivatives. </p><p>This adapter only works with <code>StateSpaceSparse</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/rstepadapters.jl#L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.adapt!-Tuple{StateSpaceSparse, SelectiveRStepAdapter, Vector{var&quot;#s68&quot;} where var&quot;#s68&quot;&lt;:AbstractFloat, Vector{var&quot;#s67&quot;} where var&quot;#s67&quot;&lt;:AbstractFloat, AbstractFloat, AbstractFloat, AbstractFloat}" href="#NumCME.adapt!-Tuple{StateSpaceSparse, SelectiveRStepAdapter, Vector{var&quot;#s68&quot;} where var&quot;#s68&quot;&lt;:AbstractFloat, Vector{var&quot;#s67&quot;} where var&quot;#s67&quot;&lt;:AbstractFloat, AbstractFloat, AbstractFloat, AbstractFloat}"><code>NumCME.adapt!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">adapt!(statespace::StateSpaceSparse, adapter::SelectiveRStepAdapter, p::Vector{var&quot;#s68&quot;} where var&quot;#s68&quot;&lt;:AbstractFloat, sinks::Vector{var&quot;#s67&quot;} where var&quot;#s67&quot;&lt;:AbstractFloat, t::AbstractFloat, tend::AbstractFloat, fsptol::AbstractFloat; integrator)
</code></pre><p>Adapt the state space and probability vector based on current error recorded in the <code>sinks</code> vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/rstepadapters.jl#L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.adapt!-Union{Tuple{RealT}, Tuple{StateSpaceSparse, RStepAdapter, Vector{RealT}, Vector{RealT}, RealT, RealT, RealT}} where RealT&lt;:AbstractFloat" href="#NumCME.adapt!-Union{Tuple{RealT}, Tuple{StateSpaceSparse, RStepAdapter, Vector{RealT}, Vector{RealT}, RealT, RealT, RealT}} where RealT&lt;:AbstractFloat"><code>NumCME.adapt!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">adapt!(statespace::StateSpaceSparse, adapter::RStepAdapter, p::Array{RealT&lt;:AbstractFloat, 1}, sinks::Array{RealT&lt;:AbstractFloat, 1}, t::AbstractFloat, tend::AbstractFloat, fsptol::AbstractFloat; integrator)
</code></pre><p>Adapt the state space and probability vector based on current error recorded in the <code>sinks</code> vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/rstepadapters.jl#L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.init!-Tuple{StateSpaceSparse, RStepAdapter, Vector{var&quot;#s74&quot;} where var&quot;#s74&quot;&lt;:AbstractFloat, AbstractFloat, AbstractFloat}" href="#NumCME.init!-Tuple{StateSpaceSparse, RStepAdapter, Vector{var&quot;#s74&quot;} where var&quot;#s74&quot;&lt;:AbstractFloat, AbstractFloat, AbstractFloat}"><code>NumCME.init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">init!(statespace::StateSpaceSparse, adapter::RStepAdapter, p::Vector{var&quot;#s74&quot;} where var&quot;#s74&quot;&lt;:AbstractFloat, t::AbstractFloat, fsptol::AbstractFloat)
</code></pre><p>Make the state space and solution vector ready for FSP integration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/rstepadapters.jl#L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.init!-Union{Tuple{RealT}, Tuple{StateSpaceSparse, SelectiveRStepAdapter, Vector{RealT}, RealT, RealT}} where RealT&lt;:AbstractFloat" href="#NumCME.init!-Union{Tuple{RealT}, Tuple{StateSpaceSparse, SelectiveRStepAdapter, Vector{RealT}, RealT, RealT}} where RealT&lt;:AbstractFloat"><code>NumCME.init!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">init!(statespace::StateSpaceSparse, adapter::SelectiveRStepAdapter, p::Array{RealT&lt;:AbstractFloat, 1}, t::AbstractFloat, fsptol::AbstractFloat)
</code></pre><p><code>init!(statespace::StateSpaceSparse, adapter::SelectiveRStepAdapter, p::Vector{RealT}, t::RealT, fsptol::RealT) where {RealT &lt;: AbstractFloat}</code></p><p>Make the state space and solution vector ready for FSP integration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/rstepadapters.jl#L66">source</a></section></article><h2 id="FSP-output-format"><a class="docs-heading-anchor" href="#FSP-output-format">FSP output format</a><a id="FSP-output-format-1"></a><a class="docs-heading-anchor-permalink" href="#FSP-output-format" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NumCME.FspOutputSliceSparse" href="#NumCME.FspOutputSliceSparse"><code>NumCME.FspOutputSliceSparse</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FspOutputSliceSparse</code></pre><p>Struct to store the FSP solution at a single time. Fields: <code>t</code>, <code>p</code>, <code>sinks</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/fspoutput.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.FspOutputSparse" href="#NumCME.FspOutputSparse"><code>NumCME.FspOutputSparse</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FspOutputSparse{NS, IntT&lt;:Integer, RealT&lt;:AbstractFloat}</code></pre><p>Struct to store Finite State Projection outputs based on the sparse representation of the FSP solution.</p><p><strong>Fields</strong></p><ul><li><code>t</code>: Array of solution output times.</li><li><code>p</code>: Array of <code>FspVectorSparse</code> instances. <code>p[i]</code> is the solution at time <code>t[i]</code>.</li><li><code>sinks</code>: Probability mass accumulated at the sink states over time. </li></ul><p><strong>Usage</strong></p><p>If <code>sol</code> is of type <code>FspOutputSparse</code>, <code>sol[i]</code> will return a slice, of type <code>FspOutputSliceSparse</code> of the solution set at the <code>i</code>-th index. </p><p><strong>See also</strong></p><p><a href="#NumCME.FspOutputSliceSparse"><code>FspOutputSliceSparse</code></a>, <a href="#Base.length-Tuple{FspOutputSparse}"><code>length(::FspOutputSparse)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/fspoutput.jl#L3-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.length-Tuple{FspOutputSparse}" href="#Base.length-Tuple{FspOutputSparse}"><code>Base.length</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">length(fspoutput::FspOutputSparse) -&gt; Int64
</code></pre><p>Return number of FSP solutions in the solution set.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/fspoutput.jl#L64">source</a></section></article><h2 id="solve()-method"><a class="docs-heading-anchor" href="#solve()-method"><code>solve()</code> method</a><a id="solve()-method-1"></a><a class="docs-heading-anchor-permalink" href="#solve()-method" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CommonSolve.solve-Union{Tuple{RealT}, Tuple{IntT}, Tuple{NS}, Tuple{CmeModel, FspVectorSparse{NS, IntT, RealT}, Tuple{AbstractFloat, AbstractFloat}, AdaptiveFspSparse}} where {NS, IntT&lt;:Integer, RealT&lt;:AbstractFloat}" href="#CommonSolve.solve-Union{Tuple{RealT}, Tuple{IntT}, Tuple{NS}, Tuple{CmeModel, FspVectorSparse{NS, IntT, RealT}, Tuple{AbstractFloat, AbstractFloat}, AdaptiveFspSparse}} where {NS, IntT&lt;:Integer, RealT&lt;:AbstractFloat}"><code>CommonSolve.solve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">solve(model::CmeModel, initial_distribution::FspVectorSparse{NS, IntT&lt;:Integer, RealT&lt;:AbstractFloat}, tspan::Tuple{AbstractFloat, AbstractFloat}, fspalgorithm::AdaptiveFspSparse; saveat, fsptol, odeatol, odertol, verbose) -&gt; Any
</code></pre><p>Numerical integration for the chemical master equation using an adaptive Finite State Projection (FSP) algorithm. This method is adaptive, meaning that states will be added during the course of integration to ensure the approximation error is below the user-specified tolerance.  In addition, depending on the input <code>fspalgorithm</code>, the space adapter may delete states with low probabilities before expanding the state space. This ensures not only accuracy but also efficiency of the CME integration.</p><p><strong>Arguments</strong></p><pre><code class="nohighlight hljs">model::CmeModel</code></pre><p>Chemical Master Equation model.</p><pre><code class="nohighlight hljs">initial_distribution::FspVectorSparse</code></pre><p>Initial distribution.</p><pre><code class="nohighlight hljs">tspan::Tuple{AbstractFloat, AbstractFloat}</code></pre><p>Timespan for the integration. The first element is the starting time, the second element is the end time of the integration.</p><pre><code class="nohighlight hljs">fspalgorithm::AdaptiveFspSparse</code></pre><p>An instance of <code>AdaptiveFspSparse</code>, storing information about the specific adaptive FSP method.</p><pre><code class="nohighlight hljs">saveat::Vector{AbstractFloat} (optional)</code></pre><p>Time points to store the FSP solutions at. Default is <code>[]</code>, which means all solutions at every timestep will be stored.</p><pre><code class="nohighlight hljs">fsptol (optional)</code></pre><p>FSP truncation error tolerance. The FSP state space is adapted so that the output solution vectors sum to greater than or equal to <code>1-fsptol</code>. Default: 1.0E-6.</p><pre><code class="nohighlight hljs">odertol (optional)</code></pre><p>Relative error tolerance for the ODE solver of the ODEs resulting from FSP truncation. Default: 1.0E-4.</p><pre><code class="nohighlight hljs">odeatol (optional)</code></pre><p>Relative error tolerance for the ODE solver of the ODEs resulting from FSP truncation. Default: 1.0E-10.</p><pre><code class="nohighlight hljs">verbose (optional)</code></pre><p>Whether to output status when updating the state space. Default: false.</p><p><strong>Returns</strong></p><p>An instance of <code>FspOutputSparse</code>.</p><p><strong>See also</strong></p><p><a href="../models/#NumCME.CmeModel"><code>CmeModel</code></a>, <a href="#NumCME.AdaptiveFspSparse"><code>AdaptiveFspSparse</code></a>, <a href="#NumCME.FspOutputSparse"><code>FspOutputSparse</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/transientcme/sparse/fspsolve.jl#L64-L104">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../vectors/">« Representing the CME solution</a><a class="docs-footer-nextpage" href="../cmesenssolve/">Forward sensitivity analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 22 October 2022 15:16">Saturday 22 October 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
