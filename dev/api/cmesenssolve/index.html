<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Forward sensitivity analysis · 𝕹𝖚𝖒ℂ𝕄𝔼</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">𝕹𝖚𝖒ℂ𝕄𝔼</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/telegraph/">Telegraphic gene expression</a></li><li><a class="tocitem" href="../../examples/hog1p/">MAPK-activated transcription in yeast</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><a class="tocitem" href="../models/">CME models</a></li><li><a class="tocitem" href="../propensities/">Propensity functions</a></li><li><a class="tocitem" href="../propensity_gradients/">Gradients of propensity functions</a></li><li><a class="tocitem" href="../space/">Managing state space</a></li><li><a class="tocitem" href="../vectors/">Representing the CME solution</a></li><li><a class="tocitem" href="../cmesolve/">Transient solution of the CME</a></li><li class="is-active"><a class="tocitem" href>Forward sensitivity analysis</a><ul class="internal"><li><a class="tocitem" href="#Forward-Sensitivity-FSP-variant-specification"><span>Forward Sensitivity FSP variant specification</span></a></li><li><a class="tocitem" href="#State-space-adaptation-policy"><span>State space adaptation policy</span></a></li><li><a class="tocitem" href="#Forward-sensitivity-FSP-output-format"><span>Forward sensitivity FSP output format</span></a></li><li><a class="tocitem" href="#solve()-method"><span><code>solve()</code> method</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API reference</a></li><li class="is-active"><a href>Forward sensitivity analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Forward sensitivity analysis</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/voduchuy/NumCME.jl/blob/main/docs/src/api/cmesenssolve.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Forward-sensitivity-analysis"><a class="docs-heading-anchor" href="#Forward-sensitivity-analysis">Forward sensitivity analysis</a><a id="Forward-sensitivity-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-sensitivity-analysis" title="Permalink"></a></h1><h2 id="Forward-Sensitivity-FSP-variant-specification"><a class="docs-heading-anchor" href="#Forward-Sensitivity-FSP-variant-specification">Forward Sensitivity FSP variant specification</a><a id="Forward-Sensitivity-FSP-variant-specification-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-Sensitivity-FSP-variant-specification" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NumCME.AdaptiveForwardSensFspSparse" href="#NumCME.AdaptiveForwardSensFspSparse"><code>NumCME.AdaptiveForwardSensFspSparse</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct AdaptiveForwardSensFspSparse &lt;: ForwardSensCmeAlgorithm</code></pre><p>Type to store algorithmic options for solving a Foward Sensitivity CME problem.</p><p><strong>Fields</strong></p><ul><li><p><code>space_adapter</code></p><p>Method to adapt state space when the current solution error exceeds tolerance.</p></li></ul><ul><li><p><code>ode_method</code></p><p>An ODE solver from <code>DifferentialEquations.jl</code> to integrate the FSP-truncated problem.</p></li></ul><p><strong>See also</strong></p><p><a href="#NumCME.ForwardSensRStepAdapter"><code>ForwardSensRStepAdapter</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/forwardsenscme/sparse/forwardsenscmesparse.jl#L4-L15">source</a></section></article><h2 id="State-space-adaptation-policy"><a class="docs-heading-anchor" href="#State-space-adaptation-policy">State space adaptation policy</a><a id="State-space-adaptation-policy-1"></a><a class="docs-heading-anchor-permalink" href="#State-space-adaptation-policy" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NumCME.ForwardSensRStepAdapter" href="#NumCME.ForwardSensRStepAdapter"><code>NumCME.ForwardSensRStepAdapter</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Simple adapter based on reachability. Whenever the current FSP solution error is found to exceed the acceptable tolerance, the adapter will expand the state space by exploring all states that could be reached from the current state space within a set number of reaction events.</p><p>This adapter only works with <code>StateSpaceSparse</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/forwardsenscme/sparse/fsspaceadapterssparse.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.adapt!-Union{Tuple{RealT}, Tuple{StateSpaceSparse, ForwardSensRStepAdapter, Vector{RealT}, Array{Vector{RealT}, 1}, Vector{RealT}, Array{Vector{RealT}, 1}, RealT, RealT, RealT}} where RealT&lt;:AbstractFloat" href="#NumCME.adapt!-Union{Tuple{RealT}, Tuple{StateSpaceSparse, ForwardSensRStepAdapter, Vector{RealT}, Array{Vector{RealT}, 1}, Vector{RealT}, Array{Vector{RealT}, 1}, RealT, RealT, RealT}} where RealT&lt;:AbstractFloat"><code>NumCME.adapt!</code></a> — <span class="docstring-category">Method</span></header><section><div><p><code>adapt!(statespace::StateSpaceSparse, adapter::RStepAdapter, p::Vector{RealT}, sinks::Vector{RealT}, t::RealT, fsptol::RealT; integrator::Union{DEIntegrator, Nothing}=nothing) where {RealT &lt;: AbstractFloat}</code></p><p>Adapt the state space, probability vector and sensitivity vectors based on current error recorded in the <code>sinks</code> vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/forwardsenscme/sparse/fsspaceadapterssparse.jl#L31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.init!-Union{Tuple{RealT}, Tuple{StateSpaceSparse, ForwardSensRStepAdapter, Vector{RealT}, Array{Vector{RealT}, 1}, AbstractFloat, AbstractFloat}} where RealT&lt;:AbstractFloat" href="#NumCME.init!-Union{Tuple{RealT}, Tuple{StateSpaceSparse, ForwardSensRStepAdapter, Vector{RealT}, Array{Vector{RealT}, 1}, AbstractFloat, AbstractFloat}} where RealT&lt;:AbstractFloat"><code>NumCME.init!</code></a> — <span class="docstring-category">Method</span></header><section><div><p><code>init!(statespace::StateSpaceSparse, adapter::RStepAdapter, p::Vector{RealT}, S::Vector{Vector{RealT}}, t::RealT, fsptol::RealT) where {RealT &lt;: AbstractFloat}</code></p><p>Initialize the state space, solution vector and sensitivity indices for FSP integration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/forwardsenscme/sparse/fsspaceadapterssparse.jl#L16-L20">source</a></section></article><h2 id="Forward-sensitivity-FSP-output-format"><a class="docs-heading-anchor" href="#Forward-sensitivity-FSP-output-format">Forward sensitivity FSP output format</a><a id="Forward-sensitivity-FSP-output-format-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-sensitivity-FSP-output-format" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NumCME.ForwardSensFspOutputSliceSparse" href="#NumCME.ForwardSensFspOutputSliceSparse"><code>NumCME.ForwardSensFspOutputSliceSparse</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ForwardSensFspOutputSliceSparse</code></pre><p>Struct to store the Forward Sensitivity FSP solution at a single time. Fields: <code>t</code>, <code>p</code>, <code>S</code>, <code>sinks</code>, <code>dsinks</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/forwardsenscme/sparse/sensoutputsparse.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.ForwardSensFspOutputSparse" href="#NumCME.ForwardSensFspOutputSparse"><code>NumCME.ForwardSensFspOutputSparse</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ForwardSensFspOutputSparse{NS,IntT&lt;:Integer,RealT&lt;:AbstractFloat}</code></pre><p>Struct to store Forward Sensitivity Finite State Projection outputs based on the sparse representation of the FSP solution.</p><p><strong>Fields</strong></p><ul><li><code>t</code>: Array of solution output times.</li><li><code>p</code>: Array of <code>FspVectorSparse</code> instances. <code>p[i]</code> is the CME solution at time <code>t[i]</code>.</li><li>&#39;S&#39;: Array of arrays of <code>FspVectorSparse</code> instances. <code>S[j][i]</code> is the <code>j</code>-th partial derivative of <code>p[i]</code>. </li><li><code>sinks</code>: Probability mass accumulated at the sink states over time. <code>sinks[i]</code> is the vector of sink state probabilities at time <code>t[i]</code>.</li><li><code>dsinks</code>: Partial derivatives of sink probabilties. <code>dsinks[j][i]</code> is the <code>j</code>-th partial derivative of <code>sinks[i]</code>.</li></ul><p><strong>Usage</strong></p><p>If <code>sol</code> is of type <code>FspOutputSparse</code>, <code>sol[i]</code> will return a slice, of type <code>FspOutputSliceSparse</code> of the solution set at the <code>i</code>-th index. </p><p><strong>See also</strong></p><p><a href="#NumCME.ForwardSensFspOutputSliceSparse"><code>ForwardSensFspOutputSliceSparse</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/forwardsenscme/sparse/sensoutputsparse.jl#L1-L19">source</a></section></article><h2 id="solve()-method"><a class="docs-heading-anchor" href="#solve()-method"><code>solve()</code> method</a><a id="solve()-method-1"></a><a class="docs-heading-anchor-permalink" href="#solve()-method" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NumCME.ForwardSensFspInitialConditionSparse" href="#NumCME.ForwardSensFspInitialConditionSparse"><code>NumCME.ForwardSensFspInitialConditionSparse</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ForwardSensFspInitialConditionSparse{NS, IntT&lt;:Integer, RealT&lt;:AbstractFloat}</code></pre><p>Initial condition for Foward Sensitivity FSP in sparse format. </p><p><strong>Fields</strong></p><ul><li><p><code>states</code></p><p>List of states with nonzero initial probabilities.</p></li></ul><ul><li><p><code>p</code></p><p>List of nonzero probabilities, with <code>p[i]</code> being the probability of state <code>states[i]</code>.</p></li></ul><ul><li><p><code>S</code></p><p>List of partial derivatives, with <code>S[j][i]</code> being the <code>j</code>-th partial derivative of <code>p[i]</code>.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/forwardsenscme/sparse/forwardsenscmesparse.jl#L27-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CommonSolve.solve-Union{Tuple{RealT}, Tuple{IntT}, Tuple{NS}, Tuple{CmeModelWithSensitivity, ForwardSensFspInitialConditionSparse{NS, IntT, RealT}, Tuple{AbstractFloat, AbstractFloat}, AdaptiveForwardSensFspSparse}} where {NS, IntT&lt;:Integer, RealT&lt;:AbstractFloat}" href="#CommonSolve.solve-Union{Tuple{RealT}, Tuple{IntT}, Tuple{NS}, Tuple{CmeModelWithSensitivity, ForwardSensFspInitialConditionSparse{NS, IntT, RealT}, Tuple{AbstractFloat, AbstractFloat}, AdaptiveForwardSensFspSparse}} where {NS, IntT&lt;:Integer, RealT&lt;:AbstractFloat}"><code>CommonSolve.solve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">solve(model::CmeModelWithSensitivity, initial_condition::ForwardSensFspInitialConditionSparse{NS, IntT&lt;:Integer, RealT&lt;:AbstractFloat}, tspan::Tuple{AbstractFloat, AbstractFloat}, sensfspalgorithm::AdaptiveForwardSensFspSparse; saveat, fsptol, odeatol, odertol, verbose) -&gt; Any
</code></pre><p>Foward sensitivity Finite State Projection to compute the time-dependent probability distributions of a stochastic reaction network along with their partial derivatives with respect to model parameters.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: Stochastic reaction network model with propensity sensitivities.</li><li><code>initial_condition</code>: Initial condition.</li><li><code>tspan</code>: Time span. </li><li><code>sensfspalgorithm</code>: Forward Sesitivity FSP method, a combination of space adaptation strategy and the ODE method to integrate the FSP-truncated problem.</li><li><code>saveat</code>: timepoints to save the intermediate solutions. If left empty, all timesteps computed by the ODE solver is saved.</li><li><code>fsptol</code>: FSP error tolerance. The solver dynamically adapts the projection space so that the sum of probability mass in the truncated solution is above <code>1.0 - fsptol</code>. Default: 1.0E-6.</li><li><code>odeatol</code>: Absolute tolerance for the ODE solver. Default: 1.0E-10.</li><li><code>odertol</code>: Relative tolerance for the ODE solver. Default: 1.0E-4.</li><li><code>verbose</code>: Whether to print status when adapting state space. Default: false.</li></ul><p><strong>Returns</strong></p><p>A <code>ForwardSensFspOutputSparse</code> instance.</p><p><strong>See also</strong></p><p><a href="../vectors/#NumCME.FspVectorSparse"><code>FspVectorSparse</code></a>, <a href="#NumCME.ForwardSensFspOutputSparse"><code>ForwardSensFspOutputSparse</code></a>, <a href="#NumCME.AdaptiveForwardSensFspSparse"><code>AdaptiveForwardSensFspSparse</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/forwardsenscme/sparse/forwardsenscmesparse.jl#L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NumCME.forwardsens_initial_condition-Union{Tuple{RealT}, Tuple{IntT}, Tuple{Vector{var&quot;#s73&quot;} where var&quot;#s73&quot;&lt;:AbstractVector{IntT}, Vector{RealT}, Array{Vector{RealT}, 1}}} where {IntT&lt;:Integer, RealT&lt;:AbstractFloat}" href="#NumCME.forwardsens_initial_condition-Union{Tuple{RealT}, Tuple{IntT}, Tuple{Vector{var&quot;#s73&quot;} where var&quot;#s73&quot;&lt;:AbstractVector{IntT}, Vector{RealT}, Array{Vector{RealT}, 1}}} where {IntT&lt;:Integer, RealT&lt;:AbstractFloat}"><code>NumCME.forwardsens_initial_condition</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">forwardsens_initial_condition(states::Array{var&quot;#s73&quot;, 1} where var&quot;#s73&quot;&lt;:AbstractArray{IntT&lt;:Integer, 1}, probabilities::Array{RealT&lt;:AbstractFloat, 1}, sensitivity::Array{Array{RealT&lt;:AbstractFloat, 1}, 1}) -&gt; ForwardSensFspInitialConditionSparse
</code></pre><p>Return a <code>ForwardSensFspInitialConditionSparse</code> instance from a list of initial states <code>states</code>, initial probabilities <code>probabilities</code> and initial sensitivities <code>sensitivity</code>.   </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/voduchuy/NumCME.jl/blob/49b895afafa81ed23e293ae494226af70c176562/src/forwardsenscme/sparse/forwardsenscmesparse.jl#L55-L59">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cmesolve/">« Transient solution of the CME</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 22 October 2022 15:16">Saturday 22 October 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
